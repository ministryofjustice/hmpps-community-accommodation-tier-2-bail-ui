{% extends "./_health-needs-screen.njk" %}
{% set pageName = "mental-health" %}

{% block questions %}

  {% set mentalHealthNeedsFollowUp %}
  {{
      formPageTextArea(
        {
          fieldName: 'needsDetail',
          label: {
            text: page.questions.needsDetail.question,
            classes: "govuk-label--s"
          }
        },
        fetchContext()
      )
    }}
  {% endset %}

  {% set hasSupportNeedsFollowUp %}
  {{
      formPageTextArea(
        {
          fieldName: 'supportNeedsDetail',
          label: {
            text: page.questions.supportNeedsDetail.question,
            classes: "govuk-label--s"
          }
        },
        fetchContext()
      )
    }}
  {% endset %}

  {% set receivesTreatmentFollowUp %}
  {{
      formPageTextArea(
        {
          fieldName: 'treatmentDetail',
          label: {
            text: page.questions.treatmentDetail.question,
            classes: "govuk-label--s"
          },
          hint: {
            text: page.questions.treatmentDetail.hint
          }
        },
        fetchContext()
      )
    }}
  {% endset %}

  {% set isEngagedWithServiceFollowUp %}
  {{
      formPageTextArea(
        {
          fieldName: 'serviceDetail',
          label: {
            text: page.questions.serviceDetail.question,
            classes: "govuk-label--s"
          }
        },
        fetchContext()
      )
    }}
  {% endset %}

  <h1 class="govuk-heading-l">{{ page.title }}</h1>

  {{
    formPageRadios(
      {
        fieldName: "hasMentalHealthNeeds",
        fieldset: {
          legend: {
            text: page.questions.hasMentalHealthNeeds.question,
            classes: "govuk-fieldset__legend--m"
          }
        },
        items: [
        {
          value: "yes",
          text: "Yes",
          conditional: {
            html: mentalHealthNeedsFollowUp
          }
        },
        {
          value: "no",
          text: "No"
        }
      ]
      },
      fetchContext()
    )
  }}

  {{
    formPageRadios(
      {
        fieldName: "hasSupportNeeds",
        fieldset: {
          legend: {
            text: page.questions.hasSupportNeeds.question,
            classes: "govuk-fieldset__legend--m"
          }
        },
        items: [
        {
          value: "yes",
          text: "Yes",
          conditional: {
            html: hasSupportNeedsFollowUp
          }
        },
        {
          value: "no",
          text: "No"
        }
      ]
      },
      fetchContext()
    )
  }}

  {{
    formPageRadios(
      {
        fieldName: "receivesTreatment",
        fieldset: {
          legend: {
            text: page.questions.receivesTreatment.question,
            classes: "govuk-fieldset__legend--m"
          }
        },
        items: [
        {
          value: "yes",
          text: "Yes",
          conditional: {
            html: receivesTreatmentFollowUp
          }
        },
        {
          value: "no",
          text: "No"
        }
      ]
      },
      fetchContext()
    )
  }}

  {{
    formPageRadios(
      {
        fieldName: "isEngagedWithService",
        fieldset: {
          legend: {
            text: page.questions.isEngagedWithService.question,
            classes: "govuk-fieldset__legend--m"
          }
        },
        hint: { text: page.questions.isEngagedWithService.hint },
        items: [
          {
            value: "yes",
            text: "Yes",
            conditional: {
              html: isEngagedWithServiceFollowUp
            }
          },
          {
            value: "awaitingAssessment",
            text: "They are awaiting assessment with a mental health service"
          },
          {
            value: "no",
            text: "No"
          }
      ]
      },
      fetchContext()
    )
  }}

  {{
    formPageRadios(
      {
        fieldName: "willReferralBeMade",
        fieldset: {
          legend: {
            text: page.questions.willReferralBeMade.question,
            classes: "govuk-fieldset__legend--m"
          }
        },
        items: [
        {
          value: "yes",
          text: "Yes",
          conditional: {
            html: canManageMedsFollowUp
          }
        },
        {
          value: "no",
          text: "No",
          conditional: {
            html: cantManageMedsFollowUp
          }
        },
        {
          value: "notInPrisonCustody",
          text: "No, the applicant is not in prison custody"
        }
      ]
      },
      fetchContext()
    )
  }}

  {{
      formPageTextArea(
        {
          fieldName: 'needsPresentation',
          label: {
            text: page.questions.needsPresentation.question,
            classes: "govuk-label--s"
          },
          hint: { text: page.questions.needsPresentation.hint }
        },
        fetchContext()
      )
    }}

{% endblock %}
